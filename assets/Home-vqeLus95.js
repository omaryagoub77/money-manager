import{a as e,b as t,c as n,f as r,g as i,n as a,r as o,t as s,y as c}from"./index-CbIB8LtH.js";import{t as l}from"./Alert-DkvB9aX9.js";var u=t(c()),d=t(a()),f=()=>{let{currentUser:t}=s(),[a,c]=(0,u.useState)([]),[f,p]=(0,u.useState)([]),[m,h]=(0,u.useState)(!0),[g,_]=(0,u.useState)({deposits:0,loans:0}),[v,y]=(0,u.useState)(null);(0,u.useEffect)(()=>{(async()=>{if(t)try{let a=r(e(o,`deposits`),i(`userId`,`==`,t.uid)),s=await n(a),l=[],u=0;s.forEach(e=>{let t=e.data();l.push({id:e.id,...t}),u+=t.amount||0}),l.sort((e,t)=>{let n=e.timestamp?.toDate?.()||new Date(0);return(t.timestamp?.toDate?.()||new Date(0))-n}),c(l);let d=r(e(o,`loans`),i(`userId`,`==`,t.uid)),f=await n(d),m=[],h=0;f.forEach(e=>{let t=e.data();m.push({id:e.id,...t}),t.status===`accepted`&&(h+=t.amount||0)}),m.sort((e,t)=>{let n=e.timestamp?.toDate?.()||new Date(0);return(t.timestamp?.toDate?.()||new Date(0))-n}),p(m),_({deposits:u,loans:h})}catch(e){console.error(`Error fetching data:`,e),y(`Failed to load dashboard data. Please try again later.`)}finally{h(!1)}})()},[t]);let b=e=>{if(!e)return`N/A`;let t=e.toDate(),n=t.getHours().toString().padStart(2,`0`),r=t.getMinutes().toString().padStart(2,`0`),i=t.getDate(),a=t.toLocaleString(`default`,{month:`short`});return`${n}:${r} Â· ${i} ${a}`},x=e=>{switch(e){case`accepted`:return`status-accepted`;case`denied`:return`status-denied`;case`pending`:return`status-pending`;default:return`status-pending`}};return m?(0,d.jsx)(`div`,{className:`home-container`,children:(0,d.jsx)(`div`,{className:`loading-indicator`,children:(0,d.jsxs)(`div`,{className:`loading-dots`,children:[(0,d.jsx)(`div`,{className:`loading-dot`}),(0,d.jsx)(`div`,{className:`loading-dot`}),(0,d.jsx)(`div`,{className:`loading-dot`})]})})}):(0,d.jsxs)(`div`,{className:`home-container`,children:[(0,d.jsxs)(`div`,{className:`home-hero`,children:[(0,d.jsx)(`h1`,{className:`home-title`,children:`Dashboard`}),(0,d.jsx)(`p`,{className:`home-sub`,children:`Your financial overview`})]}),v&&(0,d.jsx)(l,{type:`error`,message:v}),(0,d.jsxs)(`div`,{className:`totals-grid`,children:[(0,d.jsxs)(`div`,{className:`total-card`,children:[(0,d.jsx)(`h3`,{children:`Total Deposits`}),(0,d.jsxs)(`p`,{className:`total-amount`,children:[`$`,g.deposits.toFixed(2)]})]}),(0,d.jsxs)(`div`,{className:`total-card`,children:[(0,d.jsx)(`h3`,{children:`Total Loans`}),(0,d.jsxs)(`p`,{className:`total-amount`,children:[`$`,g.loans.toFixed(2)]})]})]}),(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Recent Deposits`}),a.length===0?(0,d.jsx)(`p`,{className:`empty-state`,children:`No deposits found`}):(0,d.jsx)(`div`,{className:`table-container`,children:(0,d.jsxs)(`table`,{className:`data-table`,children:[(0,d.jsx)(`thead`,{children:(0,d.jsxs)(`tr`,{children:[(0,d.jsx)(`th`,{children:`Amount`}),(0,d.jsx)(`th`,{children:`Message`}),(0,d.jsx)(`th`,{children:`Date`}),(0,d.jsx)(`th`,{children:`Status`})]})}),(0,d.jsx)(`tbody`,{children:a.slice(0,5).map(e=>(0,d.jsxs)(`tr`,{children:[(0,d.jsxs)(`td`,{children:[`$`,e.amount?.toFixed(2)]}),(0,d.jsx)(`td`,{children:e.message||`N/A`}),(0,d.jsx)(`td`,{children:b(e.timestamp)}),(0,d.jsx)(`td`,{children:(0,d.jsx)(`span`,{className:`status-badge ${x(e.status||`pending`)}`,children:e.status||`pending`})})]},e.id))})]})})]}),(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Recent Loans`}),f.length===0?(0,d.jsx)(`p`,{className:`empty-state`,children:`No loans found`}):(0,d.jsx)(`div`,{className:`table-container`,children:(0,d.jsxs)(`table`,{className:`data-table`,children:[(0,d.jsx)(`thead`,{children:(0,d.jsxs)(`tr`,{children:[(0,d.jsx)(`th`,{children:`Amount`}),(0,d.jsx)(`th`,{children:`Name`}),(0,d.jsx)(`th`,{children:`Reason`}),(0,d.jsx)(`th`,{children:`Date`}),(0,d.jsx)(`th`,{children:`Status`})]})}),(0,d.jsx)(`tbody`,{children:f.slice(0,5).map(e=>(0,d.jsxs)(`tr`,{children:[(0,d.jsxs)(`td`,{children:[`$`,e.amount?.toFixed(2)]}),(0,d.jsx)(`td`,{children:e.name||`N/A`}),(0,d.jsx)(`td`,{children:e.reason||`N/A`}),(0,d.jsx)(`td`,{children:b(e.timestamp)}),(0,d.jsx)(`td`,{children:(0,d.jsx)(`span`,{className:`status-badge ${x(e.status||`pending`)}`,children:e.status||`pending`})})]},e.id))})]})})]}),(0,d.jsxs)(`div`,{className:`cards-grid`,children:[(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Deposit Money`}),(0,d.jsx)(`p`,{children:`Submit your deposits and track your financial history.`}),(0,d.jsx)(`a`,{href:`#/deposit`,children:`Deposit`})]}),(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Request Loan`}),(0,d.jsx)(`p`,{children:`Request loans and track their status.`}),(0,d.jsx)(`a`,{href:`#/loans`,children:`Loans`})]}),(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Pay Back Loans`}),(0,d.jsx)(`p`,{children:`Pay back your accepted loans.`}),(0,d.jsx)(`a`,{href:`#/payback`,children:`Pay Back`})]}),(0,d.jsxs)(`div`,{className:`card`,children:[(0,d.jsx)(`h2`,{children:`Profile`}),(0,d.jsx)(`p`,{children:`Manage your account information and settings.`}),(0,d.jsx)(`a`,{href:`#/profile`,children:`Profile`})]})]})]})};export{f as default};