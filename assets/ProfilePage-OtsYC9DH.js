import{_ as e,a as t,c as n,d as r,i,m as a,n as o,p as s,r as c,s as l,t as u,v as d}from"./index-01lwBrxr.js";var f=d(e()),p=d(o()),m=()=>{let{currentUser:e,logout:o}=u(),[d,m]=(0,f.useState)(!0),[h,g]=(0,f.useState)({fullName:``,age:``,email:``,phoneNumber:``,gender:`male`,imageUrl:``,momoNumber:``,creditCardNumber:``}),[_,v]=(0,f.useState)(!1),[y,b]=(0,f.useState)(null),[x,S]=(0,f.useState)(``),[C,w]=(0,f.useState)(null),[T,E]=(0,f.useState)(null),[D,O]=(0,f.useState)(null),[k,A]=(0,f.useState)(!1),[j,M]=(0,f.useState)(``),[N,P]=(0,f.useState)(``),F=`dlrxomdfh`,I=`Shop-preset`;(0,f.useEffect)(()=>{(async()=>{if(e)try{let i=r(t(c,`users`),a(`uid`,`==`,e.uid)),o=await n(i);if(!o.empty){let e=o.docs[0],t=e.data();g({fullName:t.fullName||``,age:t.age||``,email:t.email||``,phoneNumber:t.phoneNumber||``,gender:t.gender||`male`,imageUrl:t.imageUrl||``,momoNumber:t.momoNumber||``,creditCardNumber:t.creditCardNumber||``}),w(e.id),m(!1)}}catch(e){console.error(`Error fetching user profile:`,e)}})()},[e]);let L=e=>{let{name:t,value:n}=e.target;if(t===`momoNumber`||t===`creditCardNumber`){let e=n.replace(/[^0-9]/g,``);g(n=>({...n,[t]:e}))}else g(e=>({...e,[t]:n}))},R=e=>{let t=e.target.files[0];if(t){if(![`image/jpeg`,`image/png`,`image/webp`].includes(t.type)){P(`Only JPG/PNG/WebP images are allowed`);return}E(t),O(URL.createObjectURL(t)),P(``)}},z=async()=>{if(!T)return null;try{let e=new FormData;e.append(`file`,T),e.append(`upload_preset`,I);let t=await(await fetch(`https://api.cloudinary.com/v1_1/${F}/image/upload`,{method:`POST`,body:e})).json();if(!t.secure_url)throw Error(`Image upload failed`);return t.secure_url}catch(e){return console.error(e),P(e.message||`Failed to upload image`),null}},B=async n=>{if(n.preventDefault(),!h.fullName||!h.age||!h.email||!h.phoneNumber||!h.momoNumber||!h.creditCardNumber){P(`Please fill all required fields`);return}if(!/^\d+$/.test(h.momoNumber)){P(`MoMo Number must contain only numbers`);return}if(!/^\d+$/.test(h.creditCardNumber)){P(`Credit Card Number must contain only numbers`);return}A(!0),P(``),M(``);try{let n=h.imageUrl;if(T){let e=await z();if(!e){A(!1);return}n=e}let r={...h,imageUrl:n,updatedAt:new Date};if(C)await s(l(c,`users`,C),r);else{let n=await i(t(c,`users`),{...r,uid:e.uid,createdAt:new Date});w(n.id)}g(e=>({...e,imageUrl:n})),E(null),O(null),M(`Profile updated successfully!`),m(!1)}catch(e){console.error(`Error saving profile data:`,e),P(`Failed to save profile. Please try again.`)}finally{A(!1)}},V=(e,t)=>{b(e),S(t)},H=async()=>{if(!(!y||!C)){if((y===`momoNumber`||y===`creditCardNumber`)&&x&&!/^\d+$/.test(x)){P(`${y===`momoNumber`?`MoMo Number`:`Credit Card Number`} must contain only numbers`);return}try{await s(l(c,`users`,C),{[y]:x,updatedAt:new Date}),g(e=>({...e,[y]:x})),b(null),S(``),M(`Field updated successfully!`)}catch(e){console.error(`Error updating field:`,e),P(`Failed to update. Please try again.`)}}},U=()=>{b(null),S(``)};return d?(0,p.jsx)(`div`,{className:`whatsapp-container`,children:(0,p.jsx)(`div`,{className:`main-content`,children:(0,p.jsxs)(`div`,{className:`card`,children:[(0,p.jsx)(`div`,{className:`card-header`,children:(0,p.jsx)(`h1`,{className:`card-title`,children:`Complete Your Profile`})}),(0,p.jsxs)(`div`,{className:`card-body`,children:[N&&(0,p.jsx)(`div`,{className:`alert alert-error`,children:N}),j&&(0,p.jsxs)(`div`,{className:`alert alert-success`,children:[(0,p.jsx)(`span`,{children:j}),(0,p.jsx)(`span`,{className:`alert-success-icon`,children:`âœ“âœ“`})]}),(0,p.jsxs)(`form`,{onSubmit:B,className:`profile-form`,children:[(0,p.jsxs)(`div`,{className:`profile-image-container`,children:[(0,p.jsx)(`div`,{className:`profile-image`,children:D?(0,p.jsx)(`img`,{src:D,alt:`Preview`,className:`profile-image-img`}):h.imageUrl?(0,p.jsx)(`img`,{src:h.imageUrl,alt:`Profile`,className:`profile-image-img`}):(0,p.jsx)(`span`,{className:`profile-image-initial`,children:h.fullName?.charAt(0).toUpperCase()||`U`})}),(0,p.jsxs)(`label`,{className:`image-upload-button`,children:[(0,p.jsx)(`span`,{className:`image-upload-icon`,children:`ðŸ“·`}),(0,p.jsx)(`span`,{children:T?`Change Photo`:`Upload Photo`}),(0,p.jsx)(`input`,{type:`file`,accept:`image/*`,onChange:R,className:`hidden`})]})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`fullName`,children:`Full Name`}),(0,p.jsx)(`input`,{className:`form-input`,id:`fullName`,name:`fullName`,type:`text`,placeholder:`Enter your full name`,value:h.fullName,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`age`,children:`Age`}),(0,p.jsx)(`input`,{className:`form-input`,id:`age`,name:`age`,type:`number`,placeholder:`Enter your age`,value:h.age,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`email`,children:`Email`}),(0,p.jsx)(`input`,{className:`form-input`,id:`email`,name:`email`,type:`email`,placeholder:`Enter your email`,value:h.email,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`phoneNumber`,children:`Phone Number`}),(0,p.jsx)(`input`,{className:`form-input`,id:`phoneNumber`,name:`phoneNumber`,type:`tel`,placeholder:`Enter your phone number`,value:h.phoneNumber,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`momoNumber`,children:`MoMo Number`}),(0,p.jsx)(`input`,{className:`form-input`,id:`momoNumber`,name:`momoNumber`,type:`text`,placeholder:`Enter your MoMo number`,value:h.momoNumber,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,htmlFor:`creditCardNumber`,children:`Credit Card Number`}),(0,p.jsx)(`input`,{className:`form-input`,id:`creditCardNumber`,name:`creditCardNumber`,type:`text`,placeholder:`Enter your credit card number`,value:h.creditCardNumber,onChange:L,required:!0})]}),(0,p.jsxs)(`div`,{className:`form-group`,children:[(0,p.jsx)(`label`,{className:`form-label`,children:`Gender`}),(0,p.jsxs)(`div`,{className:`radio-group`,children:[(0,p.jsxs)(`label`,{className:`radio-label`,children:[(0,p.jsx)(`input`,{type:`radio`,name:`gender`,value:`male`,checked:h.gender===`male`,onChange:L,className:`radio-input`}),(0,p.jsx)(`span`,{className:`radio-label-text`,children:`Male`})]}),(0,p.jsxs)(`label`,{className:`radio-label`,children:[(0,p.jsx)(`input`,{type:`radio`,name:`gender`,value:`female`,checked:h.gender===`female`,onChange:L,className:`radio-input`}),(0,p.jsx)(`span`,{className:`radio-label-text`,children:`Female`})]})]})]}),(0,p.jsx)(`div`,{className:`form-actions`,children:(0,p.jsx)(`button`,{type:`submit`,disabled:k,className:`btn btn-primary`,children:k?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(`div`,{className:`loading-spinner`,children:[(0,p.jsx)(`div`,{className:`loading-spinner-inner`}),(0,p.jsx)(`div`,{className:`loading-spinner-outer`})]}),`Saving...`]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`button-icon`,children:`âœ“`}),`Save Profile`]})})})]})]})]})})}):(0,p.jsx)(`div`,{className:`whatsapp-container`,children:(0,p.jsx)(`div`,{className:`main-content`,children:(0,p.jsxs)(`div`,{className:`card`,children:[(0,p.jsx)(`div`,{className:`card-header`,children:(0,p.jsx)(`h1`,{className:`card-title`,children:`Your Profile`})}),(0,p.jsxs)(`div`,{className:`card-body`,children:[N&&(0,p.jsx)(`div`,{className:`alert alert-error`,children:N}),j&&(0,p.jsxs)(`div`,{className:`alert alert-success`,children:[(0,p.jsx)(`span`,{children:j}),(0,p.jsx)(`span`,{className:`alert-success-icon`,children:`âœ“âœ“`})]}),(0,p.jsxs)(`div`,{className:`profile-header`,children:[(0,p.jsxs)(`div`,{className:`profile-avatar`,children:[h.imageUrl?(0,p.jsx)(`img`,{src:h.imageUrl,alt:`Profile`,className:`profile-avatar-img`}):h.fullName?.charAt(0).toUpperCase()||`U`,(0,p.jsx)(`button`,{onClick:()=>document.getElementById(`profile-image-input`).click(),className:`edit-avatar-button`,disabled:k,children:k?(0,p.jsxs)(`div`,{className:`loading-spinner`,children:[(0,p.jsx)(`div`,{className:`loading-spinner-inner`}),(0,p.jsx)(`div`,{className:`loading-spinner-outer`})]}):(0,p.jsx)(`span`,{children:`âœï¸`})}),(0,p.jsx)(`input`,{id:`profile-image-input`,type:`file`,accept:`image/*`,className:`hidden`,onChange:async e=>{let t=e.target.files[0];if(t){if(![`image/jpeg`,`image/png`,`image/webp`].includes(t.type)){P(`Only JPG/PNG/WebP images are allowed`);return}A(!0),P(``);try{let e=new FormData;e.append(`file`,t),e.append(`upload_preset`,I);let n=await(await fetch(`https://api.cloudinary.com/v1_1/${F}/image/upload`,{method:`POST`,body:e})).json();if(!n.secure_url)throw Error(`Image upload failed`);await s(l(c,`users`,C),{imageUrl:n.secure_url,updatedAt:new Date}),g(e=>({...e,imageUrl:n.secure_url})),M(`Profile image updated successfully!`)}catch(e){console.error(e),P(e.message||`Failed to upload image`)}finally{A(!1),e.target.value=``}}}})]}),(0,p.jsx)(`h2`,{className:`profile-name`,children:h.fullName||`User`}),(0,p.jsxs)(`p`,{className:`profile-id`,children:[`User ID: `,e?.uid]})]}),(0,p.jsxs)(`div`,{className:`info-section`,children:[(0,p.jsx)(`h3`,{className:`info-title`,children:`Account Information`}),(0,p.jsxs)(`div`,{className:`info-list`,children:[(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Full Name:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`fullName`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`text`,value:x,onChange:e=>S(e.target.value),className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.fullName}),(0,p.jsx)(`button`,{onClick:()=>V(`fullName`,h.fullName),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Age:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`age`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`number`,value:x,onChange:e=>S(e.target.value),className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.age}),(0,p.jsx)(`button`,{onClick:()=>V(`age`,h.age),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Email:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`email`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`email`,value:x,onChange:e=>S(e.target.value),className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.email}),(0,p.jsx)(`button`,{onClick:()=>V(`email`,h.email),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Phone Number:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`phoneNumber`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`tel`,value:x,onChange:e=>S(e.target.value),className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.phoneNumber}),(0,p.jsx)(`button`,{onClick:()=>V(`phoneNumber`,h.phoneNumber),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`MoMo Number:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`momoNumber`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`text`,value:x,onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,``);S(t)},className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.momoNumber||`N/A`}),(0,p.jsx)(`button`,{onClick:()=>V(`momoNumber`,h.momoNumber),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Credit Card Number:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`creditCardNumber`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsx)(`input`,{type:`text`,value:x,onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,``);S(t)},className:`edit-input`}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value`,children:h.creditCardNumber?`â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ `+h.creditCardNumber.slice(-4):`N/A`}),(0,p.jsx)(`button`,{onClick:()=>V(`creditCardNumber`,h.creditCardNumber),className:`edit-button`,children:`âœï¸`})]})})]})}),(0,p.jsx)(`div`,{className:`info-item`,children:(0,p.jsxs)(`div`,{className:`info-row`,children:[(0,p.jsx)(`span`,{className:`info-label`,children:`Gender:`}),(0,p.jsx)(`div`,{className:`info-value-container`,children:y===`gender`?(0,p.jsxs)(`div`,{className:`edit-form`,children:[(0,p.jsxs)(`select`,{value:x,onChange:e=>S(e.target.value),className:`edit-input`,children:[(0,p.jsx)(`option`,{value:`male`,children:`Male`}),(0,p.jsx)(`option`,{value:`female`,children:`Female`})]}),(0,p.jsx)(`button`,{onClick:H,className:`edit-save-button`,children:`âœ“`}),(0,p.jsx)(`button`,{onClick:U,className:`edit-cancel-button`,children:`âœ•`})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(`span`,{className:`info-value capitalize`,children:h.gender}),(0,p.jsx)(`button`,{onClick:()=>V(`gender`,h.gender),className:`edit-button`,children:`âœï¸`})]})})]})})]})]}),(0,p.jsxs)(`div`,{className:`action-buttons`,children:[(0,p.jsxs)(`button`,{onClick:()=>m(!0),className:`btn btn-secondary`,children:[(0,p.jsx)(`span`,{className:`button-icon`,children:`âœï¸`}),`Edit Full Profile`]}),(0,p.jsxs)(`button`,{onClick:async()=>{try{await o()}catch(e){console.error(`Failed to logout`,e)}},className:`btn btn-danger`,children:[(0,p.jsx)(`span`,{className:`button-icon`,children:`ðŸšª`}),`Logout`]})]})]})]})})})};export{m as default};